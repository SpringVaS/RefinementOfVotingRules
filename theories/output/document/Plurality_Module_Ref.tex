%
\begin{isabellebody}%
\setisabellecontext{Plurality{\isacharunderscore}{\kern0pt}Module{\isacharunderscore}{\kern0pt}Ref}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Plurality{\isacharunderscore}{\kern0pt}Module{\isacharunderscore}{\kern0pt}Ref\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}Verified{\isacharunderscore}{\kern0pt}Voting{\isacharunderscore}{\kern0pt}Rule{\isacharunderscore}{\kern0pt}Construction{\isachardot}{\kern0pt}Electoral{\isacharunderscore}{\kern0pt}Module{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}Component{\isacharunderscore}{\kern0pt}Types{\isacharslash}{\kern0pt}Electoral{\isacharunderscore}{\kern0pt}Module{\isacharunderscore}{\kern0pt}Ref{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}Verified{\isacharunderscore}{\kern0pt}Voting{\isacharunderscore}{\kern0pt}Rule{\isacharunderscore}{\kern0pt}Construction{\isachardot}{\kern0pt}Plurality{\isacharunderscore}{\kern0pt}Module{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ plurality{\isacharunderscore}{\kern0pt}r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Electoral{\isacharunderscore}{\kern0pt}Module{\isacharunderscore}{\kern0pt}Ref{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}plurality{\isacharunderscore}{\kern0pt}r\ A\ p\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}a\ {\isasymin}\ A{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ A{\isachardot}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ p\ x\ {\isasymle}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ p\ a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharbraceleft}{\kern0pt}a\ {\isasymin}\ A{\isachardot}{\kern0pt}\ {\isasymexists}x\ {\isasymin}\ A{\isachardot}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ p\ x\ {\isachargreater}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ p\ a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ datarefplurality{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ A{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}plurality{\isacharunderscore}{\kern0pt}r\ A{\isacharcomma}{\kern0pt}\ plurality\ A{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}br\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}\ \isanewline
\ \ \ \ Id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}rcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ refine{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}defs{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ Electoral{\isacharunderscore}{\kern0pt}Module{\isacharunderscore}{\kern0pt}Ref{\isacharunderscore}{\kern0pt}T\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Result{\isacharunderscore}{\kern0pt}Ref\ nres{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ initmap\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymrightharpoonup}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}initmap\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}SOME\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}a{\isasymin}A{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}m\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ computewcforcands\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymrightharpoonup}\ nat{\isacharparenright}{\kern0pt}\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}computewcforcands\ A\ p\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ wcmap{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ wcmap{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}i\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ ballot\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}i{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ winner\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ballot{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ wcmap\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}wcmap\ winner\ {\isacharequal}{\kern0pt}\ None{\isacharparenright}{\kern0pt}\ then\ wcmap\ {\isacharparenleft}{\kern0pt}winner\ {\isasymmapsto}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ else\ wcmap\ {\isacharparenleft}{\kern0pt}winner\ {\isasymmapsto}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}wcmap\ winner{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ i\ {\isacharequal}{\kern0pt}\ i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ wcmap{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ Map{\isachardot}{\kern0pt}empty{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ wcmap\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ wcmap{\isacharunderscore}{\kern0pt}correc\ {\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}a\ A\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}computewcforcands\ A\ p\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ m{\isachardot}{\kern0pt}\ {\isasymforall}\ a\ {\isasymin}\ A{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}m\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ computewcforcands{\isacharunderscore}{\kern0pt}def\ initmap{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ WHILET{\isacharunderscore}{\kern0pt}rule{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ R{\isacharequal}{\kern0pt}{\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}vcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{oops}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\ \isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Plurality_Module_Ref.tex%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%20=5%:%
%:%23=6%:%
%:%24=7%:%
%:%25=8%:%
%:%26=8%:%
%:%27=9%:%
%:%30=12%:%
%:%31=13%:%
%:%32=14%:%
%:%33=14%:%
%:%34=15%:%
%:%35=16%:%
%:%38=17%:%
%:%42=17%:%
%:%43=17%:%
%:%44=18%:%
%:%45=18%:%
%:%46=19%:%
%:%47=20%:%
%:%53=20%:%
%:%56=21%:%
%:%57=22%:%
%:%58=22%:%
%:%59=23%:%
%:%60=24%:%
%:%61=24%:%
%:%62=25%:%
%:%63=26%:%
%:%64=27%:%
%:%65=28%:%
%:%66=29%:%
%:%67=29%:%
%:%68=30%:%
%:%79=41%:%
%:%80=42%:%
%:%81=43%:%
%:%82=43%:%
%:%83=44%:%
%:%86=45%:%
%:%90=45%:%
%:%91=45%:%
%:%92=46%:%
%:%93=46%:%
%:%94=47%:%
%:%95=47%:%
%:%96=48%:%
%:%104=48%:%
%:%107=49%:%
%:%112=50%:%
