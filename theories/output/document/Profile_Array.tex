%
\begin{isabellebody}%
\setisabellecontext{Profile{\isacharunderscore}{\kern0pt}Array}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Profile{\isacharunderscore}{\kern0pt}Array\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}Verified{\isacharunderscore}{\kern0pt}Voting{\isacharunderscore}{\kern0pt}Rule{\isacharunderscore}{\kern0pt}Construction{\isachardot}{\kern0pt}Profile{\isachardoublequoteclose}\isanewline
\ \ Preference{\isacharunderscore}{\kern0pt}List\ \isanewline
\ \ {\isachardoublequoteopen}List{\isacharminus}{\kern0pt}Index{\isachardot}{\kern0pt}List{\isacharunderscore}{\kern0pt}Index{\isachardoublequoteclose}\isanewline
\ \ CAVA{\isacharunderscore}{\kern0pt}Base{\isachardot}{\kern0pt}CAVA{\isacharunderscore}{\kern0pt}Base\ \isanewline
\ \ {\isachardoublequoteopen}Collections{\isachardot}{\kern0pt}Diff{\isacharunderscore}{\kern0pt}Array{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{notation}\isamarkupfalse%
\ array{\isacharunderscore}{\kern0pt}get\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{9}}{\isadigit{0}}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ {\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}list\ {\isacharbrackleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}List{\isacharparenright}{\kern0pt}\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ pr{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}Preference{\isacharunderscore}{\kern0pt}List{\isachardot}{\kern0pt}pl{\isacharunderscore}{\kern0pt}{\isasymalpha}{\isacharparenright}{\kern0pt}\ pr{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Array\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ array{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}pref{\isacharunderscore}{\kern0pt}array\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}pref{\isacharunderscore}{\kern0pt}array\ x\ ballot\ y\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}length\ ballot{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ c\ {\isacharequal}{\kern0pt}\ ballot{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}i{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ ret\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}c\ {\isacharequal}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ then\ True\ else\ False{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ i\ {\isacharequal}{\kern0pt}\ i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}True{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Array{\isacharparenright}{\kern0pt}\ array{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}l\ A\ pr{\isadigit{1}}\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymforall}\ i{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ length\ pr{\isadigit{1}}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}pr{\isadigit{1}}{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isasymand}\ linear{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}l\ A\ {\isacharparenleft}{\kern0pt}pr{\isadigit{1}}{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa\ pa\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}length\ pa\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymand}\ distinct\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ wfa{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}wfl{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa\ pa\ {\isasymlongrightarrow}\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa{\isacharunderscore}{\kern0pt}def\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}invariant\ ballot{\isacharunderscore}{\kern0pt}a\ a\ {\isasymequiv}\ {\isasymlambda}\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ {\isasymforall}idx\ {\isacharless}{\kern0pt}\ i{\isachardot}{\kern0pt}\ ballot{\isacharunderscore}{\kern0pt}a{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}idx{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymnoteq}\ a\ {\isasymor}\ rank\ {\isacharequal}{\kern0pt}\ i{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}mon\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}mon\ ballot{\isacharunderscore}{\kern0pt}a\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}length\ ballot{\isacharunderscore}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymand}\ rank\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ rank\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}ballot{\isacharunderscore}{\kern0pt}a{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}i{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ i\ {\isacharequal}{\kern0pt}\ i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ rank{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ rank\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ prof{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa\ a{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}mon\ ballot{\isacharunderscore}{\kern0pt}a\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ r{\isachardot}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ rank\ {\isacharparenleft}{\kern0pt}pl{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ ballot{\isacharunderscore}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}def\ rank{\isacharunderscore}{\kern0pt}l{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ WHILET{\isacharunderscore}{\kern0pt}rule{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ I{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}invariant\ ballot{\isacharunderscore}{\kern0pt}a\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ R{\isacharequal}{\kern0pt}{\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}length\ ballot{\isacharunderscore}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}vcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ rank{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}invariant{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ nir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ i\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ ballot{\isacharunderscore}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ nir\ prof\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}idx\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ ballot{\isacharunderscore}{\kern0pt}a{\isachardot}{\kern0pt}\ ballot{\isacharunderscore}{\kern0pt}a{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}idx{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymnoteq}\ a\ {\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}prefa{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \isanewline
\ \ \isacommand{oops}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Profile Array abstraction functions%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ pa\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ pa\ {\isacharequal}{\kern0pt}\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ pl{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pa\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}pl{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pa\ pa\ {\isacharequal}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}array{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pa{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Profile properties and refinement%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}a\ A\ pa\ {\isacharequal}{\kern0pt}\ profile{\isacharunderscore}{\kern0pt}l\ A\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}finite{\isacharunderscore}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A\ pa\ {\isasymequiv}\ finite\ A\ {\isasymand}\ profile{\isacharunderscore}{\kern0pt}a\ A\ pa{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}data{\isacharunderscore}{\kern0pt}refine{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}pr{\isacharparenright}{\kern0pt}{\isasymin}build{\isacharunderscore}{\kern0pt}rel\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}profile\ A\ pr{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}intro\ allI\ impI{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ pr{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ ir\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ ir\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}linear{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}l\ A\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ this\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}linear{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on\ A\ {\isacharparenleft}{\kern0pt}pr\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ linorder{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}rel\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv\ ir\ length{\isacharunderscore}{\kern0pt}map\ nth{\isacharunderscore}{\kern0pt}map\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}l{\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}a\ A\ pa{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}l\ A\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ profile{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}rel{\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}a\ A\ pa{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}profile\ A\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}data{\isacharunderscore}{\kern0pt}refine\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ brI\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr{\isacharunderscore}{\kern0pt}def\ profile{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Monadic redifintion of counting functions.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}wc{\isacharunderscore}{\kern0pt}invar\ p{\isadigit{0}}\ a\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ r\ {\isasymle}\ length\ p{\isadigit{0}}\ \isanewline
\ \ {\isasymand}\ ac\ {\isacharequal}{\kern0pt}\ card{\isacharbraceleft}{\kern0pt}i{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p{\isadigit{0}}{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}r{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}rank\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}r{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ p\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ WHILET{\isacharunderscore}{\kern0pt}rule{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ I{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}wc{\isacharunderscore}{\kern0pt}invar\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ R{\isacharequal}{\kern0pt}{\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}vcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ wc{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ subst{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ conjI\ impI{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ atop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ atop\ \isacommand{have}\isamarkupfalse%
\ prep{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}r{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ \ \ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}Suc\ {\isacharparenleft}{\kern0pt}card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ atop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ a\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\isanewline
\ \ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ less{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ carde{\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ pprofile{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}profile\ A\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ pprofile\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ profile{\isacharunderscore}{\kern0pt}def\ rank{\isachardot}{\kern0pt}simps\ Preference{\isacharunderscore}{\kern0pt}Relation{\isachardot}{\kern0pt}rankone{\isadigit{1}}\ Preference{\isacharunderscore}{\kern0pt}Relation{\isachardot}{\kern0pt}rankone{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ prof{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}profile\ A\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r\ p\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ WHILET{\isacharunderscore}{\kern0pt}rule{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ I{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}wc{\isacharunderscore}{\kern0pt}invar\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ R{\isacharequal}{\kern0pt}{\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}vcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ wc{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ subst{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}safe{\isacharcomma}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ aa\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ aail{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}aa\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ rank{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ aa{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Suc\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ aail\ prof\ rank{\isadigit{1}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ aa{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ profile{\isacharunderscore}{\kern0pt}def\ rank{\isachardot}{\kern0pt}simps\ rankone{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ prep{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}aa{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}Suc\ {\isacharparenleft}{\kern0pt}card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ aa\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ aail{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}aa\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ rank{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ aa{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ Suc\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ aail\ rank{\isadigit{1}}\ \isacommand{have}\isamarkupfalse%
\ neq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ aa{\isacharparenright}{\kern0pt}\ a\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ seteq{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharequal}{\kern0pt}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharequal}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ neq\ \isacommand{have}\isamarkupfalse%
\ emp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharequal}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ seteq\ emp\ \isacommand{have}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\isanewline
\ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ aa\ {\isasymand}\ above\ {\isacharparenleft}{\kern0pt}p\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ winsr\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}Relation\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}winsr\ r\ a\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}rank\ r\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ winsr\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}r{\isacharparenright}{\kern0pt}\ a{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ prof{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}profile\ A\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer\ p\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ p\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer\ p\ a\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r\ p\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}def\ winsr{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ eq\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}correct\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ prof\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{schematic{\isacharunderscore}{\kern0pt}goal}\isamarkupfalse%
\ wc{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}RETURN\ {\isacharquery}{\kern0pt}wc{\isacharunderscore}{\kern0pt}code\ {\isasymle}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ p\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}transfer{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{concrete{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}code\ \isakeyword{for}\ p\ a\ \isakeyword{uses}\ wc{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}aux\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}equiv{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count\ p\ a\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}code\ p\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ order{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}code{\isachardot}{\kern0pt}refine\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}correct{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}code\ p\ a\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ p\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{export{\isacharunderscore}{\kern0pt}code}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count\ \isakeyword{in}\ Scala%
\begin{isamarkuptext}%
Data refinement%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}winsr{\isacharunderscore}{\kern0pt}imp\ l\ a\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}rank{\isacharunderscore}{\kern0pt}l\ l\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Preference{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ l\ a\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}l{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}refine{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}linear{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}l\ A\ l{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}l{\isacharcomma}{\kern0pt}r{\isacharparenright}{\kern0pt}{\isasymin}build{\isacharunderscore}{\kern0pt}rel\ pl{\isacharunderscore}{\kern0pt}{\isasymalpha}\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}winsr{\isacharunderscore}{\kern0pt}imp\ l\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}winsr\ r\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}def\ winsr{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ rankeq\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl\ l{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ l\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}winsr{\isacharunderscore}{\kern0pt}imp\ l\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ safe{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}List{\isacharunderscore}{\kern0pt}Index{\isachardot}{\kern0pt}index\ l\ {\isacharparenleft}{\kern0pt}l\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ index{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ amem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}List{\isachardot}{\kern0pt}member\ l\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ anhd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}l{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isasymnoteq}\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ amem\ anhd\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ List{\isacharunderscore}{\kern0pt}Index{\isachardot}{\kern0pt}index\ l\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ gr{\isadigit{0}}I\ in{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}member\ nth{\isacharunderscore}{\kern0pt}index{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ nmem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ List{\isachardot}{\kern0pt}member\ l\ {\isacharparenleft}{\kern0pt}l{\isacharbang}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ fstex{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ l\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ nmem\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ l\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ length{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}conv\ member{\isacharunderscore}{\kern0pt}def\ nth{\isacharunderscore}{\kern0pt}mem\ set{\isacharunderscore}{\kern0pt}empty{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}l\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}empty\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ this\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}False{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}winsr{\isacharunderscore}{\kern0pt}imp\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}r{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}refine{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}pr{\isacharparenright}{\kern0pt}{\isasymin}build{\isacharunderscore}{\kern0pt}rel\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp\ pl\ a\ {\isasymle}\ {\isasymDown}Id\ {\isacharparenleft}{\kern0pt}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer\ pr\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}rcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}dref{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ %
\isamarkupcmt{Type-based heuristics to instantiate data 
    refinement goals%
}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ refine{\isacharunderscore}{\kern0pt}hsimp\ refine{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}defs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ \ winsr{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}refine\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv\ profile{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}pr{\isacharparenright}{\kern0pt}{\isasymin}build{\isacharunderscore}{\kern0pt}rel\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp\ pl\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ pr\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ ref{\isacharunderscore}{\kern0pt}two{\isacharunderscore}{\kern0pt}step{\isacharbrackleft}{\kern0pt}OF\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}refine\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}outer{\isacharunderscore}{\kern0pt}correct{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ profile{\isacharunderscore}{\kern0pt}data{\isacharunderscore}{\kern0pt}refine\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\ \ \isanewline
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}List\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}r\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ballot\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}r{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ ballot\ a{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}refine{\isacharcolon}{\kern0pt}\ \isakeyword{assumes}\ {\isachardoublequoteopen}profile{\isacharunderscore}{\kern0pt}l\ A\ pl{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ pl\ a\ {\isasymle}\ {\isasymDown}Id\ {\isacharparenleft}{\kern0pt}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp\ pl\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}def\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}def\ wc{\isacharunderscore}{\kern0pt}invar{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}rcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}dref{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\ %
\isamarkupcmt{Type-based heuristics to instantiate data 
    refinement goals%
}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ refine{\isacharunderscore}{\kern0pt}hsimp\ refine{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}defs{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ range{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ mem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}List{\isachardot}{\kern0pt}member\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ fst{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}List{\isacharunderscore}{\kern0pt}Index{\isachardot}{\kern0pt}index\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ mem\ fst\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}pl{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}member\ nth{\isacharunderscore}{\kern0pt}index{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ range{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ mem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}List{\isachardot}{\kern0pt}member\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ nfst{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}List{\isacharunderscore}{\kern0pt}Index{\isachardot}{\kern0pt}index\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ a\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ mem\ nfst\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}pl{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isasymnoteq}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ index{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ range{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ nmem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ List{\isachardot}{\kern0pt}member\ {\isacharparenleft}{\kern0pt}pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ range\ \isacommand{have}\isamarkupfalse%
\ nonempty{\isacharunderscore}{\kern0pt}ballot{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ profile{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}def\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ len{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}nonempty{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}l{\isasymnoteq}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}l{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ List{\isachardot}{\kern0pt}member\ l\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ length{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}conv\ member{\isacharunderscore}{\kern0pt}def\ nth{\isacharunderscore}{\kern0pt}mem{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ this\ nonempty{\isacharunderscore}{\kern0pt}ballot\ nmem\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}pl{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharbang}{\kern0pt}{\isadigit{0}}\ {\isasymnoteq}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ length{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}conv\ member{\isacharunderscore}{\kern0pt}def\ nth{\isacharunderscore}{\kern0pt}mem{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}pr{\isacharparenright}{\kern0pt}{\isasymin}build{\isacharunderscore}{\kern0pt}rel\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ pl\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ pr\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ ref{\isacharunderscore}{\kern0pt}two{\isacharunderscore}{\kern0pt}step{\isacharbrackleft}{\kern0pt}OF\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}refine\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}correct{\isacharbrackright}{\kern0pt}\ assms\ refine{\isacharunderscore}{\kern0pt}IdD\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Moving from Lists to Arrays%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile{\isacharunderscore}{\kern0pt}Array\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ p\ a\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}i\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ballot\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}i{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}ballot{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ i\ {\isacharequal}{\kern0pt}\ i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}refine{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pa{\isacharcomma}{\kern0pt}\ pl{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ pa\ a\ {\isasymle}\ {\isasymDown}Id\ {\isacharparenleft}{\kern0pt}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}\ pl\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ winsr{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}rcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}dref{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharcomma}{\kern0pt}\ safe{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ pa{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}array{\isacharunderscore}{\kern0pt}length\ pa\ {\isacharequal}{\kern0pt}\ length\ {\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}list{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ ir\ this\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ ir\ \isacommand{show}\isamarkupfalse%
\ g{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length\ pa{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ array{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}list\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ afst{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ ir\ \isacommand{have}\isamarkupfalse%
\ arrayac{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbang}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Diff{\isacharunderscore}{\kern0pt}Array{\isachardot}{\kern0pt}array{\isachardot}{\kern0pt}exhaust\ array{\isacharunderscore}{\kern0pt}get{\isachardot}{\kern0pt}simps\ list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ ir\ arrayac\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}pl{\isacharbang}{\kern0pt}\ x{\isadigit{1}}\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x{\isadigit{1}}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x{\isadigit{1}}\ {\isacharless}{\kern0pt}\ length\ pl{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ neq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isasymnoteq}\ pl\ {\isacharbang}{\kern0pt}\ x{\isadigit{1}}\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ ir\ \isacommand{have}\isamarkupfalse%
\ arrayac{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array\ pa{\isacharparenright}{\kern0pt}{\isacharbang}{\kern0pt}x{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbang}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Diff{\isacharunderscore}{\kern0pt}Array{\isachardot}{\kern0pt}array{\isachardot}{\kern0pt}exhaust\ array{\isacharunderscore}{\kern0pt}get{\isachardot}{\kern0pt}simps\ list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}array{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ ir\ arrayac\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}pl{\isacharbang}{\kern0pt}\ x{\isadigit{1}}\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ pa{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\ well{\isacharunderscore}{\kern0pt}formed{\isacharunderscore}{\kern0pt}pl{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ neq\ this\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}False{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}step{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isasymcirc}\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}conv\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pa{\isacharcomma}{\kern0pt}\ pr{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ pa\ a\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}ac{\isachardot}{\kern0pt}\ ac\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ pr\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ ref{\isacharunderscore}{\kern0pt}two{\isacharunderscore}{\kern0pt}step{\isacharbrackleft}{\kern0pt}OF\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}refine\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}correct{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ td{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}pa\ pl\ A\ pr\ Aa\ a{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}pa{\isacharcomma}{\kern0pt}\ pl{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}\ pr{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ Aa{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ \isanewline
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ pa\ a\ {\isasymle}\ {\isasymDown}\ nat{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ pr\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ pl\ \isakeyword{where}\ r{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pa{\isacharcomma}{\kern0pt}\ pl{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pl\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ r{\isadigit{1}}\ \isacommand{have}\isamarkupfalse%
\ r{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pl{\isacharcomma}{\kern0pt}\ pr{\isacharparenright}{\kern0pt}\ {\isasymin}\ br\ pr{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isasymalpha}\ {\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}l\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}step\ assms\ profile{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}l\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ comp{\isacharunderscore}{\kern0pt}def\ in{\isacharunderscore}{\kern0pt}br{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ r{\isadigit{1}}\ r{\isadigit{2}}\ td\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}trans{\isacharunderscore}{\kern0pt}additional{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ singleton{\isacharunderscore}{\kern0pt}conv\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}correct\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}refine{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{schematic{\isacharunderscore}{\kern0pt}goal}\isamarkupfalse%
\ wc{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}refine{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}RETURN\ {\isacharquery}{\kern0pt}wc{\isacharunderscore}{\kern0pt}code\ {\isasymle}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}\ p\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}refine{\isacharunderscore}{\kern0pt}transfer{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{concrete{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ \isakeyword{for}\ p\ a\ \isakeyword{uses}\ wc{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}refine{\isacharunderscore}{\kern0pt}aux\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}array{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ lg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ pa\ a\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ pa{\isacharparenright}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ lg\ order{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code{\isachardot}{\kern0pt}refine\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isadigit{2}}{\isacharunderscore}{\kern0pt}correct{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ of\ pa\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}defs{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}array{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ lg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}profile{\isacharunderscore}{\kern0pt}a\ A\ pa{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}win{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}pa{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}pr\ pa{\isacharparenright}{\kern0pt}\ a\ {\isacharequal}{\kern0pt}\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}code\ pa\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ lg\ win{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}array{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ \ {\isachardoublequoteopen}prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}invariant\ p\ x\ y\ {\isasymequiv}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ r\ {\isasymle}\ length\ p\ {\isasymand}\isanewline
\ \ \ \ \ \ ac\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}i{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}let\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}\ in\ {\isacharparenleft}{\kern0pt}y\ {\isasympreceq}\isactrlsub r\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ Profile\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ nres{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ p\ x\ y\ {\isasymequiv}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\ {\isasymleftarrow}\ WHILET\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ ASSERT\ {\isacharparenleft}{\kern0pt}i\ {\isacharless}{\kern0pt}\ length\ p{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ b\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ ac\ {\isacharequal}{\kern0pt}\ ac\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ y\ {\isasympreceq}\isactrlsub b\ x\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ let\ i\ {\isacharequal}{\kern0pt}\ i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ RETURN\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ ac{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ RETURN\ ac\isanewline
{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon\ p\ a\ b\ {\isasymle}\ SPEC\ {\isacharparenleft}{\kern0pt}{\isasymlambda}\ wc{\isachardot}{\kern0pt}\ wc\ {\isacharequal}{\kern0pt}\ prefer{\isacharunderscore}{\kern0pt}count\ p\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}mon{\isacharunderscore}{\kern0pt}def\ prefer{\isacharunderscore}{\kern0pt}count{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ WHILET{\isacharunderscore}{\kern0pt}rule{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ I{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}invariant\ p\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isakeyword{and}\ R{\isacharequal}{\kern0pt}{\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}length\ p{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ refine{\isacharunderscore}{\kern0pt}vcg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ prefer{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}invariant{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ subst{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ conjI\ impI{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ r\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ blpa{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p{\isacharbang}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ blpa\ \isacommand{have}\isamarkupfalse%
\ prep{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}r{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}Suc\ {\isacharparenleft}{\kern0pt}card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ r\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ ir{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ length\ p{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ bnlpa{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymnotin}\ p{\isacharbang}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ bnlpa\ ir\ \isacommand{show}\isamarkupfalse%
\ prep{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ Suc\ r\ {\isasymand}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ p\ {\isacharbang}{\kern0pt}\ i{\isacharbraceright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}eq\ \isacommand{by}\isamarkupfalse%
\ metis\ \ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Profile_Array.tex%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%16=6%:%
%:%17=7%:%
%:%22=7%:%
%:%25=8%:%
%:%26=9%:%
%:%27=9%:%
%:%28=10%:%
%:%29=11%:%
%:%30=11%:%
%:%31=12%:%
%:%32=13%:%
%:%33=13%:%
%:%34=14%:%
%:%35=15%:%
%:%36=15%:%
%:%37=16%:%
%:%38=17%:%
%:%39=18%:%
%:%40=18%:%
%:%41=19%:%
%:%42=20%:%
%:%43=21%:%
%:%44=21%:%
%:%45=22%:%
%:%54=31%:%
%:%55=32%:%
%:%56=33%:%
%:%57=33%:%
%:%58=34%:%
%:%59=35%:%
%:%60=35%:%
%:%61=36%:%
%:%62=37%:%
%:%63=38%:%
%:%64=39%:%
%:%65=39%:%
%:%66=40%:%
%:%67=41%:%
%:%68=42%:%
%:%69=42%:%
%:%72=43%:%
%:%76=43%:%
%:%77=43%:%
%:%78=44%:%
%:%79=44%:%
%:%84=44%:%
%:%87=45%:%
%:%88=46%:%
%:%89=46%:%
%:%90=47%:%
%:%91=48%:%
%:%92=49%:%
%:%93=49%:%
%:%94=50%:%
%:%102=58%:%
%:%103=59%:%
%:%104=60%:%
%:%105=60%:%
%:%106=61%:%
%:%109=62%:%
%:%113=62%:%
%:%114=62%:%
%:%115=63%:%
%:%116=63%:%
%:%117=64%:%
%:%118=64%:%
%:%119=65%:%
%:%120=65%:%
%:%121=66%:%
%:%122=66%:%
%:%123=67%:%
%:%124=67%:%
%:%125=68%:%
%:%126=68%:%
%:%127=69%:%
%:%128=69%:%
%:%129=69%:%
%:%130=70%:%
%:%131=70%:%
%:%132=71%:%
%:%133=72%:%
%:%143=76%:%
%:%145=78%:%
%:%146=78%:%
%:%147=79%:%
%:%148=80%:%
%:%149=81%:%
%:%150=81%:%
%:%151=82%:%
%:%152=83%:%
%:%153=84%:%
%:%154=84%:%
%:%155=85%:%
%:%157=87%:%
%:%159=89%:%
%:%160=89%:%
%:%161=90%:%
%:%162=91%:%
%:%163=92%:%
%:%164=92%:%
%:%165=93%:%
%:%166=94%:%
%:%167=95%:%
%:%168=95%:%
%:%169=96%:%
%:%170=97%:%
%:%173=98%:%
%:%177=98%:%
%:%178=98%:%
%:%179=99%:%
%:%180=99%:%
%:%181=100%:%
%:%182=100%:%
%:%183=101%:%
%:%184=101%:%
%:%185=102%:%
%:%186=102%:%
%:%187=103%:%
%:%188=103%:%
%:%189=103%:%
%:%190=103%:%
%:%191=104%:%
%:%192=104%:%
%:%193=105%:%
%:%194=105%:%
%:%195=105%:%
%:%196=105%:%
%:%197=106%:%
%:%198=106%:%
%:%199=107%:%
%:%200=107%:%
%:%201=107%:%
%:%202=107%:%
%:%203=108%:%
%:%204=108%:%
%:%205=109%:%
%:%206=109%:%
%:%207=110%:%
%:%213=110%:%
%:%216=111%:%
%:%217=112%:%
%:%218=112%:%
%:%219=113%:%
%:%222=114%:%
%:%226=114%:%
%:%227=114%:%
%:%228=114%:%
%:%233=114%:%
%:%236=115%:%
%:%237=116%:%
%:%238=116%:%
%:%239=117%:%
%:%242=118%:%
%:%246=118%:%
%:%247=118%:%
%:%248=119%:%
%:%249=119%:%
%:%258=123%:%
%:%260=126%:%
%:%261=126%:%
%:%263=128%:%
%:%264=129%:%
%:%265=130%:%
%:%266=130%:%
%:%267=131%:%
%:%275=139%:%
%:%276=140%:%
%:%277=141%:%
%:%278=142%:%
%:%279=142%:%
%:%280=143%:%
%:%288=151%:%
%:%289=152%:%
%:%290=153%:%
%:%291=155%:%
%:%292=158%:%
%:%293=159%:%
%:%294=160%:%
%:%295=160%:%
%:%296=161%:%
%:%299=162%:%
%:%303=162%:%
%:%304=162%:%
%:%305=163%:%
%:%306=163%:%
%:%307=164%:%
%:%308=164%:%
%:%309=165%:%
%:%310=165%:%
%:%311=166%:%
%:%312=166%:%
%:%313=167%:%
%:%314=167%:%
%:%315=168%:%
%:%316=168%:%
%:%317=169%:%
%:%318=169%:%
%:%319=170%:%
%:%320=170%:%
%:%321=171%:%
%:%322=171%:%
%:%323=172%:%
%:%324=172%:%
%:%325=173%:%
%:%326=173%:%
%:%327=173%:%
%:%328=174%:%
%:%329=175%:%
%:%330=176%:%
%:%331=176%:%
%:%332=177%:%
%:%333=177%:%
%:%334=177%:%
%:%335=178%:%
%:%336=179%:%
%:%337=180%:%
%:%338=180%:%
%:%339=181%:%
%:%340=181%:%
%:%341=182%:%
%:%342=182%:%
%:%343=183%:%
%:%344=183%:%
%:%345=184%:%
%:%346=184%:%
%:%347=185%:%
%:%348=185%:%
%:%349=185%:%
%:%351=187%:%
%:%352=188%:%
%:%353=188%:%
%:%354=189%:%
%:%360=189%:%
%:%363=190%:%
%:%364=191%:%
%:%365=191%:%
%:%366=192%:%
%:%369=193%:%
%:%373=193%:%
%:%374=193%:%
%:%375=194%:%
%:%376=194%:%
%:%381=194%:%
%:%384=195%:%
%:%385=196%:%
%:%386=196%:%
%:%387=197%:%
%:%388=198%:%
%:%391=199%:%
%:%395=199%:%
%:%396=199%:%
%:%397=200%:%
%:%398=200%:%
%:%399=201%:%
%:%400=201%:%
%:%401=202%:%
%:%402=202%:%
%:%403=203%:%
%:%404=203%:%
%:%405=204%:%
%:%406=204%:%
%:%407=205%:%
%:%408=205%:%
%:%409=206%:%
%:%410=206%:%
%:%411=207%:%
%:%412=207%:%
%:%413=208%:%
%:%414=208%:%
%:%415=209%:%
%:%416=209%:%
%:%417=209%:%
%:%418=210%:%
%:%419=210%:%
%:%420=211%:%
%:%421=211%:%
%:%422=211%:%
%:%423=212%:%
%:%424=213%:%
%:%425=214%:%
%:%426=214%:%
%:%427=215%:%
%:%428=215%:%
%:%429=215%:%
%:%430=216%:%
%:%431=217%:%
%:%432=218%:%
%:%433=218%:%
%:%434=219%:%
%:%435=219%:%
%:%436=220%:%
%:%437=220%:%
%:%438=221%:%
%:%439=221%:%
%:%440=222%:%
%:%441=222%:%
%:%442=223%:%
%:%443=223%:%
%:%444=223%:%
%:%445=224%:%
%:%446=224%:%
%:%447=225%:%
%:%448=225%:%
%:%449=226%:%
%:%450=227%:%
%:%451=228%:%
%:%452=228%:%
%:%453=229%:%
%:%454=229%:%
%:%455=229%:%
%:%456=229%:%
%:%457=230%:%
%:%458=230%:%
%:%459=230%:%
%:%460=231%:%
%:%461=232%:%
%:%462=232%:%
%:%463=233%:%
%:%464=233%:%
%:%465=233%:%
%:%467=235%:%
%:%468=236%:%
%:%469=236%:%
%:%470=237%:%
%:%476=237%:%
%:%479=238%:%
%:%480=239%:%
%:%481=239%:%
%:%482=240%:%
%:%483=241%:%
%:%484=242%:%
%:%485=242%:%
%:%486=243%:%
%:%494=251%:%
%:%495=252%:%
%:%496=253%:%
%:%497=253%:%
%:%498=254%:%
%:%499=255%:%
%:%506=256%:%
%:%507=256%:%
%:%508=257%:%
%:%509=257%:%
%:%510=258%:%
%:%511=258%:%
%:%512=259%:%
%:%513=259%:%
%:%514=260%:%
%:%515=260%:%
%:%516=260%:%
%:%517=260%:%
%:%518=261%:%
%:%519=261%:%
%:%520=261%:%
%:%521=262%:%
%:%527=262%:%
%:%530=263%:%
%:%531=264%:%
%:%532=264%:%
%:%535=265%:%
%:%539=265%:%
%:%540=265%:%
%:%541=266%:%
%:%542=266%:%
%:%547=266%:%
%:%550=267%:%
%:%551=268%:%
%:%552=268%:%
%:%553=269%:%
%:%554=270%:%
%:%555=270%:%
%:%556=271%:%
%:%563=272%:%
%:%564=272%:%
%:%565=273%:%
%:%566=273%:%
%:%567=274%:%
%:%568=274%:%
%:%569=275%:%
%:%570=275%:%
%:%571=276%:%
%:%572=276%:%
%:%573=276%:%
%:%574=277%:%
%:%580=277%:%
%:%583=278%:%
%:%584=279%:%
%:%585=279%:%
%:%587=281%:%
%:%589=283%:%
%:%590=283%:%
%:%591=284%:%
%:%592=285%:%
%:%593=286%:%
%:%594=286%:%
%:%595=287%:%
%:%596=288%:%
%:%597=289%:%
%:%598=289%:%
%:%599=290%:%
%:%600=291%:%
%:%601=292%:%
%:%604=293%:%
%:%608=293%:%
%:%609=293%:%
%:%610=294%:%
%:%611=294%:%
%:%612=295%:%
%:%613=295%:%
%:%618=295%:%
%:%621=296%:%
%:%622=297%:%
%:%623=297%:%
%:%624=298%:%
%:%625=299%:%
%:%628=300%:%
%:%632=300%:%
%:%633=300%:%
%:%634=301%:%
%:%635=301%:%
%:%636=302%:%
%:%637=302%:%
%:%638=303%:%
%:%639=303%:%
%:%640=304%:%
%:%641=304%:%
%:%642=305%:%
%:%643=305%:%
%:%644=306%:%
%:%645=306%:%
%:%646=307%:%
%:%647=307%:%
%:%648=307%:%
%:%649=308%:%
%:%650=308%:%
%:%651=309%:%
%:%652=309%:%
%:%653=310%:%
%:%654=310%:%
%:%655=311%:%
%:%656=311%:%
%:%657=312%:%
%:%658=312%:%
%:%659=312%:%
%:%660=313%:%
%:%661=313%:%
%:%662=314%:%
%:%663=314%:%
%:%664=314%:%
%:%665=315%:%
%:%666=315%:%
%:%667=315%:%
%:%668=316%:%
%:%669=316%:%
%:%670=316%:%
%:%671=316%:%
%:%672=316%:%
%:%673=317%:%
%:%679=317%:%
%:%682=318%:%
%:%683=319%:%
%:%684=320%:%
%:%685=320%:%
%:%686=321%:%
%:%694=329%:%
%:%695=330%:%
%:%696=331%:%
%:%697=332%:%
%:%698=332%:%
%:%699=333%:%
%:%700=334%:%
%:%703=335%:%
%:%707=335%:%
%:%708=335%:%
%:%709=335%:%
%:%710=336%:%
%:%711=336%:%
%:%712=337%:%
%:%713=337%:%
%:%714=337%:%
%:%715=338%:%
%:%716=338%:%
%:%717=339%:%
%:%718=339%:%
%:%719=340%:%
%:%720=340%:%
%:%721=341%:%
%:%722=342%:%
%:%723=342%:%
%:%724=343%:%
%:%725=343%:%
%:%730=343%:%
%:%733=344%:%
%:%734=345%:%
%:%735=345%:%
%:%736=346%:%
%:%737=347%:%
%:%740=348%:%
%:%744=348%:%
%:%745=348%:%
%:%746=349%:%
%:%747=349%:%
%:%752=349%:%
%:%755=350%:%
%:%756=351%:%
%:%757=352%:%
%:%758=352%:%
%:%759=353%:%
%:%768=362%:%
%:%769=363%:%
%:%770=364%:%
%:%771=365%:%
%:%772=365%:%
%:%773=366%:%
%:%776=367%:%
%:%780=367%:%
%:%781=367%:%
%:%782=368%:%
%:%783=368%:%
%:%784=369%:%
%:%785=369%:%
%:%786=369%:%
%:%787=370%:%
%:%788=370%:%
%:%789=371%:%
%:%790=371%:%
%:%791=372%:%
%:%792=372%:%
%:%793=373%:%
%:%794=374%:%
%:%795=374%:%
%:%796=375%:%
%:%797=375%:%
%:%798=376%:%
%:%799=376%:%
%:%800=377%:%
%:%801=377%:%
%:%802=378%:%
%:%803=378%:%
%:%804=379%:%
%:%805=379%:%
%:%806=379%:%
%:%807=380%:%
%:%808=380%:%
%:%809=381%:%
%:%810=381%:%
%:%811=382%:%
%:%812=382%:%
%:%813=383%:%
%:%814=383%:%
%:%815=384%:%
%:%816=384%:%
%:%817=385%:%
%:%818=385%:%
%:%819=386%:%
%:%820=386%:%
%:%821=386%:%
%:%822=387%:%
%:%823=387%:%
%:%824=388%:%
%:%825=388%:%
%:%826=389%:%
%:%827=389%:%
%:%828=390%:%
%:%829=390%:%
%:%830=391%:%
%:%831=391%:%
%:%832=392%:%
%:%833=392%:%
%:%834=392%:%
%:%835=392%:%
%:%836=393%:%
%:%837=393%:%
%:%838=394%:%
%:%839=394%:%
%:%840=395%:%
%:%841=395%:%
%:%842=396%:%
%:%843=396%:%
%:%844=396%:%
%:%845=397%:%
%:%846=397%:%
%:%847=398%:%
%:%853=398%:%
%:%856=399%:%
%:%857=400%:%
%:%858=400%:%
%:%859=401%:%
%:%860=402%:%
%:%863=403%:%
%:%867=403%:%
%:%868=403%:%
%:%869=404%:%
%:%870=404%:%
%:%879=407%:%
%:%881=409%:%
%:%882=409%:%
%:%883=410%:%
%:%892=419%:%
%:%893=420%:%
%:%894=421%:%
%:%895=421%:%
%:%896=422%:%
%:%897=423%:%
%:%900=424%:%
%:%904=424%:%
%:%905=424%:%
%:%906=425%:%
%:%907=425%:%
%:%908=426%:%
%:%909=426%:%
%:%910=427%:%
%:%911=427%:%
%:%912=428%:%
%:%913=428%:%
%:%914=429%:%
%:%915=429%:%
%:%916=430%:%
%:%917=430%:%
%:%918=431%:%
%:%919=431%:%
%:%920=432%:%
%:%921=432%:%
%:%922=433%:%
%:%923=433%:%
%:%924=433%:%
%:%925=433%:%
%:%926=434%:%
%:%927=434%:%
%:%928=435%:%
%:%929=435%:%
%:%930=436%:%
%:%931=436%:%
%:%932=437%:%
%:%933=437%:%
%:%934=438%:%
%:%935=438%:%
%:%936=438%:%
%:%937=438%:%
%:%938=439%:%
%:%939=439%:%
%:%940=440%:%
%:%941=440%:%
%:%942=441%:%
%:%943=441%:%
%:%944=442%:%
%:%945=442%:%
%:%946=443%:%
%:%947=443%:%
%:%948=444%:%
%:%949=444%:%
%:%950=444%:%
%:%951=445%:%
%:%952=445%:%
%:%953=446%:%
%:%954=446%:%
%:%955=446%:%
%:%956=447%:%
%:%957=447%:%
%:%958=448%:%
%:%959=448%:%
%:%960=449%:%
%:%961=449%:%
%:%962=450%:%
%:%963=450%:%
%:%964=451%:%
%:%965=451%:%
%:%966=452%:%
%:%967=452%:%
%:%968=453%:%
%:%969=453%:%
%:%970=453%:%
%:%971=454%:%
%:%972=454%:%
%:%973=455%:%
%:%974=455%:%
%:%975=455%:%
%:%976=456%:%
%:%977=456%:%
%:%978=457%:%
%:%979=457%:%
%:%980=458%:%
%:%981=458%:%
%:%982=458%:%
%:%983=458%:%
%:%984=459%:%
%:%990=459%:%
%:%993=460%:%
%:%994=461%:%
%:%995=461%:%
%:%998=462%:%
%:%1002=462%:%
%:%1003=462%:%
%:%1008=462%:%
%:%1011=463%:%
%:%1012=464%:%
%:%1013=464%:%
%:%1014=465%:%
%:%1015=466%:%
%:%1018=467%:%
%:%1022=467%:%
%:%1023=467%:%
%:%1024=468%:%
%:%1025=468%:%
%:%1026=469%:%
%:%1027=469%:%
%:%1030=472%:%
%:%1031=473%:%
%:%1032=473%:%
%:%1033=474%:%
%:%1034=474%:%
%:%1035=475%:%
%:%1036=475%:%
%:%1037=475%:%
%:%1038=475%:%
%:%1039=476%:%
%:%1040=476%:%
%:%1041=477%:%
%:%1042=477%:%
%:%1043=477%:%
%:%1044=478%:%
%:%1045=478%:%
%:%1046=479%:%
%:%1047=479%:%
%:%1048=480%:%
%:%1054=480%:%
%:%1057=481%:%
%:%1058=482%:%
%:%1059=482%:%
%:%1062=483%:%
%:%1066=483%:%
%:%1067=483%:%
%:%1068=484%:%
%:%1069=484%:%
%:%1074=484%:%
%:%1077=485%:%
%:%1078=486%:%
%:%1079=486%:%
%:%1080=487%:%
%:%1081=488%:%
%:%1082=488%:%
%:%1083=489%:%
%:%1084=490%:%
%:%1087=491%:%
%:%1091=491%:%
%:%1092=491%:%
%:%1093=492%:%
%:%1094=493%:%
%:%1095=493%:%
%:%1100=493%:%
%:%1103=494%:%
%:%1104=495%:%
%:%1105=495%:%
%:%1106=496%:%
%:%1107=497%:%
%:%1110=498%:%
%:%1114=498%:%
%:%1115=498%:%
%:%1120=498%:%
%:%1123=499%:%
%:%1124=500%:%
%:%1125=501%:%
%:%1126=501%:%
%:%1128=503%:%
%:%1129=504%:%
%:%1130=505%:%
%:%1131=505%:%
%:%1132=506%:%
%:%1141=515%:%
%:%1142=516%:%
%:%1143=517%:%
%:%1144=517%:%
%:%1145=518%:%
%:%1148=519%:%
%:%1152=519%:%
%:%1153=519%:%
%:%1154=520%:%
%:%1155=520%:%
%:%1156=521%:%
%:%1157=522%:%
%:%1158=522%:%
%:%1159=523%:%
%:%1160=523%:%
%:%1161=524%:%
%:%1162=524%:%
%:%1163=525%:%
%:%1164=525%:%
%:%1165=526%:%
%:%1166=526%:%
%:%1167=527%:%
%:%1168=527%:%
%:%1169=528%:%
%:%1170=528%:%
%:%1171=529%:%
%:%1172=529%:%
%:%1173=530%:%
%:%1174=530%:%
%:%1175=531%:%
%:%1176=531%:%
%:%1177=531%:%
%:%1178=532%:%
%:%1179=533%:%
%:%1180=534%:%
%:%1181=534%:%
%:%1182=535%:%
%:%1183=535%:%
%:%1184=536%:%
%:%1185=536%:%
%:%1186=537%:%
%:%1187=537%:%
%:%1188=538%:%
%:%1189=538%:%
%:%1190=539%:%
%:%1191=539%:%
%:%1192=540%:%
%:%1193=540%:%
%:%1194=541%:%
%:%1195=541%:%
%:%1196=541%:%
%:%1197=542%:%
%:%1198=543%:%
%:%1199=544%:%
%:%1200=544%:%
%:%1201=544%:%
%:%1202=545%:%
%:%1208=545%:%
%:%1213=546%:%
%:%1218=547%:%
